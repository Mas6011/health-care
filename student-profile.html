<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Profile - SMK CERIA HEALTH CARE</title>
    <style>
        /* Modern App Styles */
        body {
            font-family: Arial, Helvetica, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
        }

        .profile-container {
            background-color: white;
            padding: 40px;
            width: 450px;
            border-radius: 20px;
            border: 2px solid #cbd5e1;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }

        .header-title {
            font-size: 18px;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 5px;
        }

        h2 {
            margin: 0 0 25px 0;
            font-size: 22px;
            color: #3b82f6;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
            text-decoration: none; /* Removed underline to match modern look */
        }

        .info-layout {
            display: flex;
            gap: 25px;
            margin-bottom: 20px;
            align-items: center;
        }

        /* 3. Student Picture Box */
        .p-box {
            width: 120px;
            height: 140px;
            border: 2px solid #cbd5e1;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f8fafc;
            font-size: 50px;
            overflow: hidden; /* Clips the image to rounded corners */
        }

        .p-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .details p {
            margin: 8px 0;
            font-size: 18px;
            color: #334155;
        }

        /* 4 & 5. Medical Info Section */
        .medical-info {
            background-color: #fff1f2;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #f43f5e;
            margin-bottom: 25px;
        }

        .medical-info p {
            margin: 5px 0;
            font-size: 16px;
            color: #991b1b;
        }

        /* Collapsible Parents Section */
        .parents-toggle {
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            padding: 12px 20px;
            border: 1.5px solid #cbd5e1;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 15px;
            background-color: white;
            transition: 0.2s;
            color: #475569;
        }

        .parents-toggle:hover {
            background-color: #f1f5f9;
            border-color: #3b82f6;
        }

        #parents-content {
            display: none;
            padding: 20px;
            background-color: #f8fafc;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1.5px dashed #cbd5e1;
        }

        /* Action Bar */
        .action-bar {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .icon-btn {
            min-width: 85px;
            height: 55px;
            border: 2px solid #cbd5e1;
            background-color: white;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            cursor: pointer;
            position: relative;
            text-decoration: none;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            border-color: #3b82f6;
            background-color: #eff6ff;
            transform: translateY(-2px);
        }

        /* Tooltips */
        .icon-btn::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 65px;
            background-color: #1e293b;
            color: white;
            font-size: 11px;
            padding: 5px 10px;
            border-radius: 6px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }

        .icon-btn:hover::after { opacity: 1; }

        .btn-call { color: #ef4444; border-color: #fca5a5; }
    </style>
</head>
<body>

    <div class="profile-container">
        <div class="header-title">SMK CERIA HEALTH CARE</div>
        <h2><span id="display-title-name">Student</span>'s Profile</h2>

        <div class="info-layout">
            <div class="p-box" id="student-pic-container">
                <img id="student-img-display" src="" style="display:none;">
                <span id="student-emoji-default">üßë‚Äçüéì</span>
            </div>
            <div class="details">
                <p><strong>Name:</strong> <span id="display-name">Name</span></p>
                <p><strong>Class:</strong> <span id="display-class">Class</span></p>
            </div>
        </div>

        <div class="medical-info">
            <p><strong>Medical History:</strong> <span id="display-history">-</span></p>
            <p><strong>Allergy:</strong> <span id="display-allergy">-</span></p>
        </div>

        <div class="parents-toggle" onclick="toggleParents()">Parents ‚åµ</div>
        
        <div id="parents-content">
            <div style="display: flex; gap: 20px; align-items: center;">
                <div class="p-box" style="width: 80px; height: 90px; font-size: 35px;" id="parent-pic-container">
                    <img id="parent-img-display" src="" style="display:none;">
                    <span id="parent-emoji-default">üë©‚Äçüíº</span>
                </div>
                <div>
                    <p style="margin: 0; font-size: 16px;"><strong>Name:</strong> <span id="display-parent-name">Name</span></p>
                    <p style="margin: 0; font-size: 16px;"><strong>Phone:</strong> <span id="display-parent-phone">01XXXXXXXX</span></p>
                </div>
            </div>
        </div>

        <div class="action-bar">
            <a href="dashboard.html" class="icon-btn" data-tooltip="Back to Main Menu">‚è™</a>

            <div style="display: flex; gap: 12px;">
                <div class="icon-btn btn-call" data-tooltip="Call Parents" onclick="callParent()">üìûüë™</div>
                
                <a href="edit-profile.html" class="icon-btn" data-tooltip="Edit Profile">üìù</a>
                <a href="report.html" class="icon-btn" data-tooltip="Medication Report">üíä</a>
            </div>
        </div>

    <script>
        window.onload = function() {
            // Find out which student we are looking for
            const targetName = localStorage.getItem('currentStudentName');
            const studentList = JSON.parse(localStorage.getItem('allStudents')) || [];
            const student = studentList.find(s => s.name === targetName);

            if (student) {
                // Update Text
                document.getElementById('display-name').innerText = student.name;
                document.getElementById('display-title-name').innerText = student.name;
                document.getElementById('display-class').innerText = student.class;
                document.getElementById('display-history').innerText = student.history;
                document.getElementById('display-allergy').innerText = student.allergy;
                document.getElementById('display-parent-name').innerText = student.parentName;
                document.getElementById('display-parent-phone').innerText = student.parentPhone;

                // Load Student Photo
                if (student.studentPic) {
                    const sImg = document.getElementById('student-img-display');
                    sImg.src = student.studentPic;
                    sImg.style.display = "block";
                    document.getElementById('student-emoji-default').style.display = "none";
                }

                // Load Parent Photo
                if (student.parentPic) {
                    const pImg = document.getElementById('parent-img-display');
                    pImg.src = student.parentPic;
                    pImg.style.display = "block";
                    document.getElementById('parent-emoji-default').style.display = "none";
                }
            }
        };

        function toggleParents() {
            const content = document.getElementById('parents-content');
            content.style.display = (content.style.display === "block") ? "none" : "block";
        }

        function callParent() {
            const targetName = localStorage.getItem('currentStudentName');
            const studentList = JSON.parse(localStorage.getItem('allStudents')) || [];
            const student = studentList.find(s => s.name === targetName);
            const pName = student ? student.parentName : "the parent";

            if (confirm("Do you want to initiate an emergency call to " + pName + "?")) {
                alert("Call Success");
            }
        }
    </script>
</body>
</html>